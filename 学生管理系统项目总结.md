# å­¦ç”Ÿç®¡ç†ç³»ç»Ÿé¡¹ç›®æ€»ç»“ - é›¶åŸºç¡€å®Œæ•´æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºWebçš„å­¦ç”Ÿç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œå®ç°äº†å®Œæ•´çš„å­¦ç”Ÿä¿¡æ¯ç®¡ç†åŠŸèƒ½ã€‚ç³»ç»Ÿæ”¯æŒä¸‰ç§ç”¨æˆ·è§’è‰²ï¼šç®¡ç†å‘˜ã€æ•™å¸ˆå’Œå­¦ç”Ÿï¼Œæ¯ç§è§’è‰²å…·æœ‰ä¸åŒçš„æƒé™çº§åˆ«ã€‚

**é¡¹ç›®æ ¸å¿ƒç‰¹ç‚¹ï¼š**
- ğŸ” åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼ˆRBACï¼‰
- ğŸŒ å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- ğŸ”’ JWTè®¤è¯æœºåˆ¶ï¼Œç¡®ä¿æ•°æ®å®‰å…¨
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå¤šè®¾å¤‡è®¿é—®
- ğŸ—„ï¸ MySQLæ•°æ®åº“ï¼Œæ•°æ®æŒä¹…åŒ–å­˜å‚¨

## æŠ€æœ¯æ¶æ„æ·±åº¦è§£æ

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTP/HTTPS     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    SQLæŸ¥è¯¢    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (æµè§ˆå™¨)   â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚   åç«¯ (Flask)   â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚   æ•°æ®åº“ (MySQL) â”‚
â”‚                 â”‚    JSONæ•°æ®äº¤æ¢    â”‚                 â”‚   æ•°æ®å­˜å‚¨     â”‚                 â”‚
â”‚ HTML/CSS/JS     â”‚                   â”‚ Python API      â”‚              â”‚ è¡¨ç»“æ„/ç´¢å¼•      â”‚
â”‚ Bootstrap UI    â”‚                   â”‚ è·¯ç”±/è®¤è¯/æƒé™   â”‚              â”‚ äº‹åŠ¡/çº¦æŸ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯¦è§£
- **å‰ç«¯æŠ€æœ¯æ ˆ**:
  - HTML5: é¡µé¢ç»“æ„å’Œè¯­ä¹‰åŒ–æ ‡ç­¾
  - CSS3: æ ·å¼è®¾è®¡å’Œå“åº”å¼å¸ƒå±€
  - JavaScript (ES6+): äº¤äº’é€»è¾‘å’ŒAPIè°ƒç”¨
  - Bootstrap 5: UIç»„ä»¶åº“å’Œæ …æ ¼ç³»ç»Ÿ

- **åç«¯æŠ€æœ¯æ ˆ**:
  - Python 3.8+: ä¸»è¦ç¼–ç¨‹è¯­è¨€
  - Flask 2.3+: è½»é‡çº§Webæ¡†æ¶
  - Flask-CORS: è·¨åŸŸèµ„æºå…±äº«
  - PyJWT: JWTä»¤ç‰Œå¤„ç†
  - bcrypt: å¯†ç åŠ å¯†

- **æ•°æ®åº“æŠ€æœ¯**:
  - MySQL 8.0+: å…³ç³»å‹æ•°æ®åº“
  - mysql-connector-python: Pythonæ•°æ®åº“é©±åŠ¨
  - è¿æ¥æ± : æé«˜æ•°æ®åº“è¿æ¥æ€§èƒ½

- **é€šä¿¡åè®®**:
  - HTTP/HTTPS: å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é€šä¿¡
  - JSON: æ•°æ®äº¤æ¢æ ¼å¼
  - RESTful API: æ¥å£è®¾è®¡è§„èŒƒ

## é¡¹ç›®æ–‡ä»¶ç»“æ„è¯¦è§£

### å®Œæ•´ç›®å½•ç»“æ„
```
student_management_system/                    # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ frontend/                                # å‰ç«¯æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ static/                             # é™æ€èµ„æºç›®å½•
â”‚   â”‚   â”œâ”€â”€ css/                           # æ ·å¼æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ style.css                  # ä¸»æ ·å¼æ–‡ä»¶ - è‡ªå®šä¹‰æ ·å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ bootstrap.min.css          # Bootstrapæ¡†æ¶ - UIç»„ä»¶æ ·å¼
â”‚   â”‚   â”‚   â””â”€â”€ dashboard.css              # ä»ªè¡¨æ¿ä¸“ç”¨æ ·å¼
â”‚   â”‚   â”œâ”€â”€ js/                            # JavaScriptæ–‡ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ main.js                    # ä¸»è¦ä¸šåŠ¡é€»è¾‘ - é¡µé¢äº¤äº’
â”‚   â”‚   â”‚   â”œâ”€â”€ api.js                     # APIè°ƒç”¨å°è£… - ä¸åç«¯é€šä¿¡
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js                    # ç”¨æˆ·è®¤è¯é€»è¾‘ - ç™»å½•/æƒé™
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.js                   # å·¥å…·å‡½æ•° - é€šç”¨æ–¹æ³•
â”‚   â”‚   â”‚   â””â”€â”€ components.js              # UIç»„ä»¶ - å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ images/                        # å›¾ç‰‡èµ„æºç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ logo.png                   # ç³»ç»ŸLogo
â”‚   â”‚   â”‚   â”œâ”€â”€ avatar-default.png         # é»˜è®¤å¤´åƒ
â”‚   â”‚   â”‚   â””â”€â”€ icons/                     # å›¾æ ‡æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ fonts/                         # å­—ä½“æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ templates/                         # HTMLæ¨¡æ¿ç›®å½•
â”‚       â”œâ”€â”€ index.html                     # é¦–é¡µ - ç³»ç»Ÿå…¥å£
â”‚       â”œâ”€â”€ login.html                     # ç™»å½•é¡µé¢ - ç”¨æˆ·è®¤è¯
â”‚       â”œâ”€â”€ dashboard.html                 # ä»ªè¡¨æ¿ - ä¸»ç•Œé¢
â”‚       â”œâ”€â”€ student_list.html              # å­¦ç”Ÿåˆ—è¡¨ - æ•°æ®å±•ç¤º
â”‚       â”œâ”€â”€ student_form.html              # å­¦ç”Ÿè¡¨å• - æ•°æ®å½•å…¥
â”‚       â”œâ”€â”€ user_management.html           # ç”¨æˆ·ç®¡ç† - ç®¡ç†å‘˜åŠŸèƒ½
â”‚       â””â”€â”€ profile.html                   # ä¸ªäººèµ„æ–™ - ç”¨æˆ·ä¿¡æ¯
â”œâ”€â”€ backend/                               # åç«¯æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ app.py                            # ä¸»åº”ç”¨æ–‡ä»¶ - Flaskåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py                         # é…ç½®æ–‡ä»¶ - ç³»ç»Ÿé…ç½®
â”‚   â”œâ”€â”€ models/                           # æ•°æ®æ¨¡å‹ç›®å½•
â”‚   â”‚   â”œâ”€â”€ __init__.py                   # æ¨¡å—åˆå§‹åŒ–æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ base.py                       # åŸºç¡€æ¨¡å‹ç±» - é€šç”¨æ–¹æ³•
â”‚   â”‚   â”œâ”€â”€ user.py                       # ç”¨æˆ·æ¨¡å‹ - ç”¨æˆ·æ•°æ®æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ student.py                    # å­¦ç”Ÿæ¨¡å‹ - å­¦ç”Ÿæ•°æ®æ“ä½œ
â”‚   â”‚   â””â”€â”€ class_model.py                # ç­çº§æ¨¡å‹ - ç­çº§æ•°æ®æ“ä½œ
â”‚   â”œâ”€â”€ routes/                           # è·¯ç”±å¤„ç†ç›®å½•
â”‚   â”‚   â”œâ”€â”€ __init__.py                   # è·¯ç”±æ¨¡å—åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ auth.py                       # è®¤è¯è·¯ç”± - ç™»å½•/æ³¨å†Œ/æƒé™
â”‚   â”‚   â”œâ”€â”€ student.py                    # å­¦ç”Ÿç®¡ç†è·¯ç”± - å­¦ç”ŸCRUD
â”‚   â”‚   â”œâ”€â”€ user.py                       # ç”¨æˆ·ç®¡ç†è·¯ç”± - ç”¨æˆ·CRUD
â”‚   â”‚   â”œâ”€â”€ dashboard.py                  # ä»ªè¡¨æ¿è·¯ç”± - ç»Ÿè®¡æ•°æ®
â”‚   â”‚   â””â”€â”€ api.py                        # APIè·¯ç”± - é€šç”¨æ¥å£
â”‚   â”œâ”€â”€ utils/                            # å·¥å…·å‡½æ•°ç›®å½•
â”‚   â”‚   â”œâ”€â”€ __init__.py                   # å·¥å…·æ¨¡å—åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ database.py                   # æ•°æ®åº“è¿æ¥ - è¿æ¥æ± ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ auth.py                       # è®¤è¯å·¥å…· - JWT/æƒé™éªŒè¯
â”‚   â”‚   â”œâ”€â”€ validators.py                 # æ•°æ®éªŒè¯ - è¾“å…¥éªŒè¯
â”‚   â”‚   â”œâ”€â”€ helpers.py                    # è¾…åŠ©å‡½æ•° - é€šç”¨å·¥å…·
â”‚   â”‚   â””â”€â”€ decorators.py                 # è£…é¥°å™¨ - æƒé™/æ—¥å¿—è£…é¥°å™¨
â”‚   â”œâ”€â”€ middleware/                       # ä¸­é—´ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ __init__.py                   # ä¸­é—´ä»¶åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ auth_middleware.py            # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ cors_middleware.py            # è·¨åŸŸä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ logging_middleware.py         # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â””â”€â”€ tests/                            # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”‚       â”œâ”€â”€ __init__.py                   # æµ‹è¯•æ¨¡å—åˆå§‹åŒ–
â”‚       â”œâ”€â”€ test_auth.py                  # è®¤è¯åŠŸèƒ½æµ‹è¯•
â”‚       â”œâ”€â”€ test_student.py               # å­¦ç”Ÿç®¡ç†æµ‹è¯•
â”‚       â””â”€â”€ test_api.py                   # APIæ¥å£æµ‹è¯•
â”œâ”€â”€ database/                             # æ•°æ®åº“ç›¸å…³ç›®å½•
â”‚   â”œâ”€â”€ schema.sql                        # æ•°æ®åº“ç»“æ„ - è¡¨å®šä¹‰
â”‚   â”œâ”€â”€ init_data.sql                     # åˆå§‹æ•°æ® - æµ‹è¯•æ•°æ®
â”‚   â”œâ”€â”€ migrations/                       # æ•°æ®åº“è¿ç§»ç›®å½•
â”‚   â”‚   â”œâ”€â”€ 001_create_users.sql          # åˆ›å»ºç”¨æˆ·è¡¨
â”‚   â”‚   â”œâ”€â”€ 002_create_students.sql       # åˆ›å»ºå­¦ç”Ÿè¡¨
â”‚   â”‚   â””â”€â”€ 003_create_classes.sql        # åˆ›å»ºç­çº§è¡¨
â”‚   â””â”€â”€ backup/                           # æ•°æ®åº“å¤‡ä»½ç›®å½•
â”œâ”€â”€ docs/                                 # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ API.md                           # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ DEPLOYMENT.md                    # éƒ¨ç½²æ–‡æ¡£
â”‚   â””â”€â”€ DEVELOPMENT.md                   # å¼€å‘æ–‡æ¡£
â”œâ”€â”€ scripts/                              # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ setup.sh                         # ç¯å¢ƒè®¾ç½®è„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh                        # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ backup.sh                        # å¤‡ä»½è„šæœ¬
â”œâ”€â”€ .env.example                          # ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
â”œâ”€â”€ .gitignore                           # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ requirements.txt                      # Pythonä¾èµ–æ–‡ä»¶
â”œâ”€â”€ docker-compose.yml                    # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ Dockerfile                           # Dockeré•œåƒæ–‡ä»¶
â””â”€â”€ README.md                            # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

### æ–‡ä»¶åŠŸèƒ½è¯´æ˜

**å‰ç«¯æ–‡ä»¶èŒè´£ï¼š**
- `templates/`: HTMLé¡µé¢æ¨¡æ¿ï¼Œå®šä¹‰é¡µé¢ç»“æ„
- `static/css/`: æ ·å¼æ–‡ä»¶ï¼Œæ§åˆ¶é¡µé¢å¤–è§‚
- `static/js/`: JavaScriptæ–‡ä»¶ï¼Œå®ç°é¡µé¢äº¤äº’å’ŒAPIè°ƒç”¨
- `static/images/`: å›¾ç‰‡èµ„æºï¼Œæä¾›è§†è§‰å…ƒç´ 

**åç«¯æ–‡ä»¶èŒè´£ï¼š**
- `app.py`: Flaskåº”ç”¨ä¸»å…¥å£ï¼Œé…ç½®å’Œå¯åŠ¨æœåŠ¡å™¨
- `models/`: æ•°æ®æ¨¡å‹ï¼Œå®šä¹‰æ•°æ®ç»“æ„å’Œæ•°æ®åº“æ“ä½œ
- `routes/`: è·¯ç”±å¤„ç†ï¼Œå®šä¹‰APIç«¯ç‚¹å’Œä¸šåŠ¡é€»è¾‘
- `utils/`: å·¥å…·å‡½æ•°ï¼Œæä¾›é€šç”¨åŠŸèƒ½å’Œè¾…åŠ©æ–¹æ³•
- `config.py`: é…ç½®ç®¡ç†ï¼Œç»Ÿä¸€ç®¡ç†ç³»ç»Ÿé…ç½®

**æ•°æ®åº“æ–‡ä»¶èŒè´£ï¼š**
- `schema.sql`: å®šä¹‰æ•°æ®åº“è¡¨ç»“æ„å’Œçº¦æŸ
- `init_data.sql`: æä¾›åˆå§‹æµ‹è¯•æ•°æ®
- `migrations/`: æ•°æ®åº“ç‰ˆæœ¬æ§åˆ¶å’Œç»“æ„å˜æ›´

## æ ¸å¿ƒå®ç°åŸç†

### 1. å‰åç«¯é€šä¿¡æœºåˆ¶

#### å‰ç«¯å‘èµ·è¯·æ±‚ (api.js)
```javascript
// APIè°ƒç”¨å°è£… - ç»Ÿä¸€å¤„ç†HTTPè¯·æ±‚
class ApiClient {
    constructor() {
        this.baseURL = 'http://localhost:5000/api';  // åç«¯APIåŸºç¡€URL
        this.token = localStorage.getItem('token');   // ä»æœ¬åœ°å­˜å‚¨è·å–è®¤è¯ä»¤ç‰Œ
    }
    
    // é€šç”¨è¯·æ±‚æ–¹æ³• - å°è£…fetch APIè¿›è¡ŒHTTPé€šä¿¡
    async request(endpoint, options = {}) {
        const url = `${this.baseURL}${endpoint}`;     // æ„å»ºå®Œæ•´URL
        const config = {
            headers: {
                'Content-Type': 'application/json',    // è®¾ç½®è¯·æ±‚å¤´ä¸ºJSONæ ¼å¼
                'Authorization': `Bearer ${this.token}` // æ·»åŠ è®¤è¯ä»¤ç‰Œ
            },
            ...options  // åˆå¹¶å…¶ä»–é…ç½®é€‰é¡¹
        };
        
        try {
            const response = await fetch(url, config);  // å‘èµ·HTTPè¯·æ±‚
            const data = await response.json();         // è§£æJSONå“åº”
            
            if (!response.ok) {
                throw new Error(data.message || 'è¯·æ±‚å¤±è´¥');
            }
            
            return data;  // è¿”å›å“åº”æ•°æ®
        } catch (error) {
            console.error('APIè¯·æ±‚é”™è¯¯:', error);
            throw error;
        }
    }
    
    // è·å–å­¦ç”Ÿåˆ—è¡¨ - å…·ä½“ä¸šåŠ¡æ–¹æ³•
    async getStudents() {
        return await this.request('/students');  // GETè¯·æ±‚è·å–å­¦ç”Ÿæ•°æ®
    }
    
    // åˆ›å»ºå­¦ç”Ÿ - POSTè¯·æ±‚æäº¤æ•°æ®
    async createStudent(studentData) {
        return await this.request('/students', {
            method: 'POST',
            body: JSON.stringify(studentData)  // å°†JavaScriptå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²
        });
    }
}
```

#### åç«¯æ¥æ”¶å¤„ç† (routes/student.py)
```python
from flask import Blueprint, request, jsonify
from models.student import Student
from utils.auth import require_auth, get_current_user

# åˆ›å»ºè“å›¾ - Flaskä¸­ç»„ç»‡è·¯ç”±çš„æ–¹å¼
student_bp = Blueprint('student', __name__)

# è·å–å­¦ç”Ÿåˆ—è¡¨è·¯ç”± - å¯¹åº”å‰ç«¯çš„getStudents()è°ƒç”¨
@student_bp.route('/students', methods=['GET'])
@require_auth  # è£…é¥°å™¨ï¼šè¦æ±‚ç”¨æˆ·è®¤è¯
def get_students():
    """
    è·å–å­¦ç”Ÿåˆ—è¡¨APIç«¯ç‚¹
    æ ¹æ®ç”¨æˆ·è§’è‰²è¿”å›ä¸åŒçš„æ•°æ®æƒé™
    """
    current_user = get_current_user()  # è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
    
    # æ ¹æ®ç”¨æˆ·è§’è‰²å®ç°æƒé™æ§åˆ¶
    if current_user.role == 'admin':
        # ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰å­¦ç”Ÿçš„å®Œæ•´ä¿¡æ¯
        students = Student.get_all()
    elif current_user.role == 'teacher':
        # æ•™å¸ˆå¯ä»¥çœ‹åˆ°æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯ä½†ä¸åŒ…æ‹¬æ•æ„Ÿæ•°æ®
        students = Student.get_all_for_teacher()
    else:  # student role
        # å­¦ç”Ÿåªèƒ½çœ‹åˆ°åŒç­åŒå­¦çš„åŸºæœ¬ä¿¡æ¯å’Œè‡ªå·±çš„å®Œæ•´ä¿¡æ¯
        students = Student.get_classmates_and_self(current_user.id)
    
    # å°†Pythonå¯¹è±¡è½¬æ¢ä¸ºJSONæ ¼å¼è¿”å›ç»™å‰ç«¯
    return jsonify({
        'success': True,
        'data': [student.to_dict() for student in students]
    })

# åˆ›å»ºå­¦ç”Ÿè·¯ç”± - å¯¹åº”å‰ç«¯çš„createStudent()è°ƒç”¨
@student_bp.route('/students', methods=['POST'])
@require_auth
def create_student():
    """
    åˆ›å»ºå­¦ç”ŸAPIç«¯ç‚¹
    åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºå­¦ç”Ÿè®°å½•
    """
    current_user = get_current_user()
    
    # æƒé™æ£€æŸ¥ - åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºå­¦ç”Ÿ
    if current_user.role != 'admin':
        return jsonify({'success': False, 'message': 'æƒé™ä¸è¶³'}), 403
    
    # è·å–å‰ç«¯å‘é€çš„JSONæ•°æ®
    data = request.get_json()
    
    try:
        # åˆ›å»ºå­¦ç”Ÿå¯¹è±¡å¹¶ä¿å­˜åˆ°æ•°æ®åº“
        student = Student.create(data)
        return jsonify({
            'success': True,
            'message': 'å­¦ç”Ÿåˆ›å»ºæˆåŠŸ',
            'data': student.to_dict()
        })
    except Exception as e:
        return jsonify({'success': False, 'message': str(e)}), 400
```

### 2. æ•°æ®åº“è¿æ¥ä¸æ“ä½œ

#### æ•°æ®åº“è¿æ¥ (utils/database.py)
```python
import mysql.connector
from mysql.connector import pooling
import os

class DatabaseManager:
    """
    æ•°æ®åº“ç®¡ç†ç±» - è´Ÿè´£æ•°æ®åº“è¿æ¥å’Œæ“ä½œ
    ä½¿ç”¨è¿æ¥æ± æé«˜æ€§èƒ½å’Œå¹¶å‘å¤„ç†èƒ½åŠ›
    """
    
    def __init__(self):
        # æ•°æ®åº“è¿æ¥é…ç½® - ä»ç¯å¢ƒå˜é‡æˆ–é…ç½®æ–‡ä»¶è¯»å–
        self.config = {
            'host': os.getenv('DB_HOST', 'localhost'),      # æ•°æ®åº“ä¸»æœºåœ°å€
            'port': int(os.getenv('DB_PORT', 3306)),        # æ•°æ®åº“ç«¯å£
            'user': os.getenv('DB_USER', 'root'),           # æ•°æ®åº“ç”¨æˆ·å
            'password': os.getenv('DB_PASSWORD', ''),        # æ•°æ®åº“å¯†ç 
            'database': os.getenv('DB_NAME', 'student_mgmt') # æ•°æ®åº“åç§°
        }
        
        # åˆ›å»ºè¿æ¥æ±  - ç®¡ç†å¤šä¸ªæ•°æ®åº“è¿æ¥ä»¥æé«˜æ€§èƒ½
        self.pool = pooling.MySQLConnectionPool(
            pool_name="student_pool",
            pool_size=10,  # è¿æ¥æ± å¤§å°
            **self.config
        )
    
    def get_connection(self):
        """è·å–æ•°æ®åº“è¿æ¥"""
        return self.pool.get_connection()
    
    def execute_query(self, query, params=None):
        """
        æ‰§è¡ŒæŸ¥è¯¢è¯­å¥
        ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢SQLæ³¨å…¥æ”»å‡»
        """
        connection = None
        cursor = None
        try:
            connection = self.get_connection()  # ä»è¿æ¥æ± è·å–è¿æ¥
            cursor = connection.cursor(dictionary=True)  # è¿”å›å­—å…¸æ ¼å¼ç»“æœ
            
            cursor.execute(query, params or ())  # æ‰§è¡ŒSQLè¯­å¥
            
            if query.strip().upper().startswith('SELECT'):
                return cursor.fetchall()  # æŸ¥è¯¢æ“ä½œè¿”å›ç»“æœ
            else:
                connection.commit()  # å¢åˆ æ”¹æ“ä½œæäº¤äº‹åŠ¡
                return cursor.rowcount  # è¿”å›å½±å“çš„è¡Œæ•°
                
        except Exception as e:
            if connection:
                connection.rollback()  # å‡ºé”™æ—¶å›æ»šäº‹åŠ¡
            raise e
        finally:
            # ç¡®ä¿èµ„æºè¢«æ­£ç¡®é‡Šæ”¾
            if cursor:
                cursor.close()
            if connection:
                connection.close()

# å…¨å±€æ•°æ®åº“ç®¡ç†å™¨å®ä¾‹
db_manager = DatabaseManager()
```

#### æ•°æ®æ¨¡å‹ (models/student.py)
```python
from utils.database import db_manager
from datetime import datetime

class Student:
    """
    å­¦ç”Ÿæ•°æ®æ¨¡å‹ç±» - å°è£…å­¦ç”Ÿç›¸å…³çš„æ•°æ®æ“ä½œ
    å®ç°ORM(å¯¹è±¡å…³ç³»æ˜ å°„)æ¨¡å¼ï¼Œå°†æ•°æ®åº“è®°å½•æ˜ å°„ä¸ºPythonå¯¹è±¡
    """

    def __init__(self, id=None, name=None, student_id=None, class_name=None,
                 phone=None, email=None, address=None, id_card=None,
                 created_at=None, updated_at=None):
        self.id = id                    # ä¸»é”®ID
        self.name = name                # å­¦ç”Ÿå§“å
        self.student_id = student_id    # å­¦å·
        self.class_name = class_name    # ç­çº§åç§°
        self.phone = phone              # ç”µè¯å·ç 
        self.email = email              # é‚®ç®±åœ°å€
        self.address = address          # å®¶åº­ä½å€ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
        self.id_card = id_card          # èº«ä»½è¯å·ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
        self.created_at = created_at    # åˆ›å»ºæ—¶é—´
        self.updated_at = updated_at    # æ›´æ–°æ—¶é—´

    @classmethod
    def get_all(cls):
        """
        è·å–æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯ - ç®¡ç†å‘˜æƒé™
        è¿”å›å®Œæ•´çš„å­¦ç”Ÿä¿¡æ¯åˆ—è¡¨
        """
        query = """
        SELECT id, name, student_id, class_name, phone, email,
               address, id_card, created_at, updated_at
        FROM students
        ORDER BY created_at DESC
        """
        results = db_manager.execute_query(query)
        return [cls(**row) for row in results]  # å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºStudentå¯¹è±¡åˆ—è¡¨

    @classmethod
    def get_all_for_teacher(cls):
        """
        è·å–æ•™å¸ˆå¯è§çš„å­¦ç”Ÿä¿¡æ¯ - æ•™å¸ˆæƒé™
        ä¸åŒ…å«æ•æ„Ÿä¿¡æ¯å¦‚èº«ä»½è¯å·å’Œè¯¦ç»†åœ°å€
        """
        query = """
        SELECT id, name, student_id, class_name, phone, email, created_at
        FROM students
        ORDER BY class_name, name
        """
        results = db_manager.execute_query(query)
        return [cls(**row) for row in results]

    @classmethod
    def get_classmates_and_self(cls, user_id):
        """
        è·å–åŒç­åŒå­¦å’Œè‡ªå·±çš„ä¿¡æ¯ - å­¦ç”Ÿæƒé™
        åŒç­åŒå­¦åªæ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯ï¼Œè‡ªå·±æ˜¾ç¤ºå®Œæ•´ä¿¡æ¯
        """
        # é¦–å…ˆè·å–å½“å‰å­¦ç”Ÿçš„ç­çº§ä¿¡æ¯
        user_query = """
        SELECT class_name FROM students s
        JOIN users u ON s.user_id = u.id
        WHERE u.id = %s
        """
        user_result = db_manager.execute_query(user_query, (user_id,))

        if not user_result:
            return []

        user_class = user_result[0]['class_name']

        # è·å–åŒç­åŒå­¦çš„åŸºæœ¬ä¿¡æ¯å’Œè‡ªå·±çš„å®Œæ•´ä¿¡æ¯
        query = """
        SELECT
            s.id, s.name, s.student_id, s.class_name, s.phone, s.email,
            CASE
                WHEN u.id = %s THEN s.address    -- è‡ªå·±å¯ä»¥çœ‹åˆ°å®Œæ•´åœ°å€
                ELSE NULL                        -- åŒå­¦çœ‹ä¸åˆ°åœ°å€
            END as address,
            CASE
                WHEN u.id = %s THEN s.id_card    -- è‡ªå·±å¯ä»¥çœ‹åˆ°èº«ä»½è¯
                ELSE NULL                        -- åŒå­¦çœ‹ä¸åˆ°èº«ä»½è¯
            END as id_card,
            s.created_at
        FROM students s
        JOIN users u ON s.user_id = u.id
        WHERE s.class_name = %s
        ORDER BY s.name
        """
        results = db_manager.execute_query(query, (user_id, user_id, user_class))
        return [cls(**row) for row in results]

    @classmethod
    def create(cls, data):
        """
        åˆ›å»ºæ–°å­¦ç”Ÿè®°å½•
        ä½¿ç”¨äº‹åŠ¡ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
        """
        query = """
        INSERT INTO students (name, student_id, class_name, phone, email, address, id_card)
        VALUES (%s, %s, %s, %s, %s, %s, %s)
        """
        params = (
            data['name'], data['student_id'], data['class_name'],
            data['phone'], data['email'], data['address'], data['id_card']
        )

        db_manager.execute_query(query, params)

        # è·å–æ–°åˆ›å»ºçš„å­¦ç”Ÿè®°å½•
        return cls.get_by_student_id(data['student_id'])

    @classmethod
    def get_by_student_id(cls, student_id):
        """æ ¹æ®å­¦å·è·å–å­¦ç”Ÿä¿¡æ¯"""
        query = "SELECT * FROM students WHERE student_id = %s"
        results = db_manager.execute_query(query, (student_id,))
        return cls(**results[0]) if results else None

    def to_dict(self):
        """
        å°†å­¦ç”Ÿå¯¹è±¡è½¬æ¢ä¸ºå­—å…¸æ ¼å¼
        ç”¨äºJSONåºåˆ—åŒ–ï¼Œè¿”å›ç»™å‰ç«¯
        """
        return {
            'id': self.id,
            'name': self.name,
            'student_id': self.student_id,
            'class_name': self.class_name,
            'phone': self.phone,
            'email': self.email,
            'address': self.address,      # æ ¹æ®æƒé™å¯èƒ½ä¸ºNone
            'id_card': self.id_card,      # æ ¹æ®æƒé™å¯èƒ½ä¸ºNone
            'created_at': self.created_at.isoformat() if self.created_at else None
        }
```

### 3. ç”¨æˆ·è®¤è¯ä¸æƒé™æ§åˆ¶

#### è®¤è¯å·¥å…· (utils/auth.py)
```python
import jwt
from datetime import datetime, timedelta
from functools import wraps
from flask import request, jsonify, current_app
from models.user import User

def generate_token(user_id, role):
    """
    ç”ŸæˆJWTä»¤ç‰Œ - ç”¨äºç”¨æˆ·è®¤è¯
    JWT(JSON Web Token)æ˜¯ä¸€ç§å®‰å…¨çš„ä¿¡æ¯ä¼ è¾“æ–¹å¼
    """
    payload = {
        'user_id': user_id,           # ç”¨æˆ·ID
        'role': role,                 # ç”¨æˆ·è§’è‰²
        'exp': datetime.utcnow() + timedelta(hours=24),  # è¿‡æœŸæ—¶é—´24å°æ—¶
        'iat': datetime.utcnow()      # ç­¾å‘æ—¶é—´
    }

    # ä½¿ç”¨åº”ç”¨å¯†é’¥ç­¾åä»¤ç‰Œ
    token = jwt.encode(payload, current_app.config['SECRET_KEY'], algorithm='HS256')
    return token

def verify_token(token):
    """
    éªŒè¯JWTä»¤ç‰Œ
    è¿”å›è§£ç åçš„ç”¨æˆ·ä¿¡æ¯æˆ–None
    """
    try:
        # è§£ç å¹¶éªŒè¯ä»¤ç‰Œ
        payload = jwt.decode(token, current_app.config['SECRET_KEY'], algorithms=['HS256'])
        return payload
    except jwt.ExpiredSignatureError:
        return None  # ä»¤ç‰Œå·²è¿‡æœŸ
    except jwt.InvalidTokenError:
        return None  # ä»¤ç‰Œæ— æ•ˆ

def require_auth(f):
    """
    è®¤è¯è£…é¥°å™¨ - ä¿æŠ¤éœ€è¦ç™»å½•çš„è·¯ç”±
    æ£€æŸ¥è¯·æ±‚å¤´ä¸­çš„Authorizationå­—æ®µ
    """
    @wraps(f)
    def decorated_function(*args, **kwargs):
        # ä»è¯·æ±‚å¤´è·å–ä»¤ç‰Œ
        auth_header = request.headers.get('Authorization')

        if not auth_header:
            return jsonify({'success': False, 'message': 'ç¼ºå°‘è®¤è¯ä»¤ç‰Œ'}), 401

        try:
            # æå–Bearerä»¤ç‰Œ
            token = auth_header.split(' ')[1]  # "Bearer <token>"
            payload = verify_token(token)

            if not payload:
                return jsonify({'success': False, 'message': 'æ— æ•ˆçš„è®¤è¯ä»¤ç‰Œ'}), 401

            # å°†ç”¨æˆ·ä¿¡æ¯æ·»åŠ åˆ°è¯·æ±‚ä¸Šä¸‹æ–‡
            request.current_user = payload
            return f(*args, **kwargs)

        except IndexError:
            return jsonify({'success': False, 'message': 'ä»¤ç‰Œæ ¼å¼é”™è¯¯'}), 401

    return decorated_function

def get_current_user():
    """è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„å®Œæ•´ä¿¡æ¯"""
    if hasattr(request, 'current_user'):
        user_id = request.current_user['user_id']
        return User.get_by_id(user_id)
    return None

def require_role(required_role):
    """
    è§’è‰²æƒé™è£…é¥°å™¨ - é™åˆ¶ç‰¹å®šè§’è‰²è®¿é—®
    """
    def decorator(f):
        @wraps(f)
        def decorated_function(*args, **kwargs):
            current_user = get_current_user()

            if not current_user or current_user.role != required_role:
                return jsonify({'success': False, 'message': 'æƒé™ä¸è¶³'}), 403

            return f(*args, **kwargs)
        return decorated_function
    return decorator
```

### 4. å‰ç«¯é¡µé¢å®ç°

#### ä¸»é¡µé¢ (templates/dashboard.html)
```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ - ä»ªè¡¨æ¿</title>
    <!-- å¼•å…¥Bootstrap CSSæ¡†æ¶ - æä¾›å“åº”å¼å¸ƒå±€å’Œç»„ä»¶æ ·å¼ -->
    <link href="static/css/bootstrap.css" rel="stylesheet">
    <!-- å¼•å…¥è‡ªå®šä¹‰æ ·å¼ -->
    <link href="static/css/style.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- å·¦ä¾§å¯¼èˆªæ  - å›ºå®šåœ¨é¡µé¢å·¦ä¾§ -->
            <nav class="col-md-2 sidebar">
                <div class="sidebar-header">
                    <h3>å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</h3>
                    <p id="user-info">æ¬¢è¿ï¼Œ<span id="username"></span></p>
                </div>

                <!-- å¯¼èˆªèœå• - æ ¹æ®ç”¨æˆ·è§’è‰²åŠ¨æ€æ˜¾ç¤º -->
                <ul class="nav flex-column" id="nav-menu">
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="loadPage('dashboard')">
                            <i class="icon-dashboard"></i> ä»ªè¡¨æ¿
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="loadPage('students')">
                            <i class="icon-students"></i> å­¦ç”Ÿç®¡ç†
                        </a>
                    </li>
                    <!-- ç®¡ç†å‘˜ä¸“ç”¨èœå•é¡¹ -->
                    <li class="nav-item admin-only" style="display: none;">
                        <a class="nav-link" href="#" onclick="loadPage('users')">
                            <i class="icon-users"></i> ç”¨æˆ·ç®¡ç†
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="logout()">
                            <i class="icon-logout"></i> é€€å‡ºç™»å½•
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- ä¸»å†…å®¹åŒºåŸŸ - åŠ¨æ€åŠ è½½ä¸åŒé¡µé¢å†…å®¹ -->
            <main class="col-md-10 main-content">
                <div id="content-area">
                    <!-- é¡µé¢å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½åˆ°è¿™é‡Œ -->
                    <div class="loading">åŠ è½½ä¸­...</div>
                </div>
            </main>
        </div>
    </div>

    <!-- å¼•å…¥JavaScriptæ–‡ä»¶ -->
    <script src="static/js/api.js"></script>      <!-- APIè°ƒç”¨å°è£… -->
    <script src="static/js/auth.js"></script>     <!-- è®¤è¯ç›¸å…³åŠŸèƒ½ -->
    <script src="static/js/main.js"></script>     <!-- ä¸»è¦ä¸šåŠ¡é€»è¾‘ -->
</body>
</html>
```

#### å‰ç«¯ä¸»è¦é€»è¾‘ (static/js/main.js)
```javascript
// å…¨å±€å˜é‡
let currentUser = null;  // å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
let apiClient = null;    // APIå®¢æˆ·ç«¯å®ä¾‹

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
});

/**
 * åº”ç”¨åˆå§‹åŒ–å‡½æ•°
 * æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼Œè®¾ç½®ç”¨æˆ·ç•Œé¢
 */
async function initializeApp() {
    try {
        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨ä¸­çš„è®¤è¯ä»¤ç‰Œ
        const token = localStorage.getItem('token');
        if (!token) {
            // æ²¡æœ‰ä»¤ç‰Œï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢
            window.location.href = 'login.html';
            return;
        }

        // åˆ›å»ºAPIå®¢æˆ·ç«¯å®ä¾‹
        apiClient = new ApiClient();

        // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
        currentUser = await apiClient.getCurrentUser();

        // è®¾ç½®ç”¨æˆ·ç•Œé¢
        setupUserInterface();

        // åŠ è½½é»˜è®¤é¡µé¢
        loadPage('dashboard');

    } catch (error) {
        console.error('åˆå§‹åŒ–å¤±è´¥:', error);
        // è®¤è¯å¤±è´¥ï¼Œæ¸…é™¤ä»¤ç‰Œå¹¶è·³è½¬ç™»å½•
        localStorage.removeItem('token');
        window.location.href = 'login.html';
    }
}

/**
 * è®¾ç½®ç”¨æˆ·ç•Œé¢
 * æ ¹æ®ç”¨æˆ·è§’è‰²æ˜¾ç¤ºä¸åŒçš„èœå•é¡¹
 */
function setupUserInterface() {
    // æ˜¾ç¤ºç”¨æˆ·å
    document.getElementById('username').textContent = currentUser.name;

    // æ ¹æ®ç”¨æˆ·è§’è‰²æ˜¾ç¤ºèœå•
    if (currentUser.role === 'admin') {
        // ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰èœå•é¡¹
        document.querySelectorAll('.admin-only').forEach(el => {
            el.style.display = 'block';
        });
    } else if (currentUser.role === 'teacher') {
        // æ•™å¸ˆå¯ä»¥çœ‹åˆ°å­¦ç”Ÿç®¡ç†ï¼Œä½†ä¸èƒ½çœ‹åˆ°ç”¨æˆ·ç®¡ç†
        document.querySelectorAll('.teacher-only').forEach(el => {
            el.style.display = 'block';
        });
    }
    // å­¦ç”Ÿåªèƒ½çœ‹åˆ°åŸºæœ¬èœå•é¡¹ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰
}

/**
 * åŠ¨æ€åŠ è½½é¡µé¢å†…å®¹
 * å®ç°å•é¡µåº”ç”¨(SPA)çš„é¡µé¢åˆ‡æ¢
 */
async function loadPage(pageName) {
    const contentArea = document.getElementById('content-area');

    try {
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        contentArea.innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';

        // æ ¹æ®é¡µé¢åç§°åŠ è½½ä¸åŒå†…å®¹
        switch (pageName) {
            case 'dashboard':
                await loadDashboard();
                break;
            case 'students':
                await loadStudentList();
                break;
            case 'users':
                if (currentUser.role === 'admin') {
                    await loadUserList();
                } else {
                    showError('æƒé™ä¸è¶³');
                }
                break;
            default:
                contentArea.innerHTML = '<div class="error">é¡µé¢ä¸å­˜åœ¨</div>';
        }

    } catch (error) {
        console.error('åŠ è½½é¡µé¢å¤±è´¥:', error);
        showError('åŠ è½½é¡µé¢å¤±è´¥: ' + error.message);
    }
}

/**
 * åŠ è½½ä»ªè¡¨æ¿é¡µé¢
 * æ˜¾ç¤ºç³»ç»Ÿæ¦‚è§ˆä¿¡æ¯
 */
async function loadDashboard() {
    try {
        // è·å–ç»Ÿè®¡æ•°æ®
        const stats = await apiClient.getStats();

        const html = `
            <div class="dashboard">
                <h2>ç³»ç»Ÿæ¦‚è§ˆ</h2>
                <div class="row">
                    <div class="col-md-3">
                        <div class="stat-card">
                            <h3>${stats.total_students}</h3>
                            <p>å­¦ç”Ÿæ€»æ•°</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <h3>${stats.total_classes}</h3>
                            <p>ç­çº§æ€»æ•°</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <h3>${stats.total_teachers}</h3>
                            <p>æ•™å¸ˆæ€»æ•°</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-card">
                            <h3>${stats.active_users}</h3>
                            <p>æ´»è·ƒç”¨æˆ·</p>
                        </div>
                    </div>
                </div>

                <!-- æœ€è¿‘æ´»åŠ¨ -->
                <div class="recent-activities">
                    <h3>æœ€è¿‘æ´»åŠ¨</h3>
                    <ul class="activity-list">
                        ${stats.recent_activities.map(activity => `
                            <li>${activity.time} - ${activity.description}</li>
                        `).join('')}
                    </ul>
                </div>
            </div>
        `;

        document.getElementById('content-area').innerHTML = html;

    } catch (error) {
        throw new Error('è·å–ä»ªè¡¨æ¿æ•°æ®å¤±è´¥');
    }
}

/**
 * åŠ è½½å­¦ç”Ÿåˆ—è¡¨é¡µé¢
 * æ ¹æ®ç”¨æˆ·æƒé™æ˜¾ç¤ºä¸åŒçš„å­¦ç”Ÿä¿¡æ¯
 */
async function loadStudentList() {
    try {
        // ä»åç«¯è·å–å­¦ç”Ÿæ•°æ®
        const students = await apiClient.getStudents();

        let html = `
            <div class="student-list">
                <div class="page-header">
                    <h2>å­¦ç”Ÿç®¡ç†</h2>
                    ${currentUser.role === 'admin' ?
                        '<button class="btn btn-primary" onclick="showAddStudentModal()">æ·»åŠ å­¦ç”Ÿ</button>' :
                        ''
                    }
                </div>

                <!-- æœç´¢å’Œç­›é€‰ -->
                <div class="filters">
                    <input type="text" id="search-input" placeholder="æœç´¢å­¦ç”Ÿå§“åæˆ–å­¦å·"
                           onkeyup="filterStudents()">
                    <select id="class-filter" onchange="filterStudents()">
                        <option value="">æ‰€æœ‰ç­çº§</option>
                        ${getUniqueClasses(students).map(className =>
                            `<option value="${className}">${className}</option>`
                        ).join('')}
                    </select>
                </div>

                <!-- å­¦ç”Ÿè¡¨æ ¼ -->
                <div class="table-responsive">
                    <table class="table table-striped" id="students-table">
                        <thead>
                            <tr>
                                <th>å§“å</th>
                                <th>å­¦å·</th>
                                <th>ç­çº§</th>
                                <th>ç”µè¯</th>
                                <th>é‚®ç®±</th>
                                ${shouldShowSensitiveData() ? '<th>åœ°å€</th><th>èº«ä»½è¯</th>' : ''}
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${students.map(student => createStudentRow(student)).join('')}
                        </tbody>
                    </table>
                </div>
            </div>
        `;

        document.getElementById('content-area').innerHTML = html;

    } catch (error) {
        throw new Error('è·å–å­¦ç”Ÿåˆ—è¡¨å¤±è´¥');
    }
}

/**
 * åˆ›å»ºå­¦ç”Ÿè¡¨æ ¼è¡Œ
 * æ ¹æ®æƒé™æ˜¾ç¤ºä¸åŒçš„å­—æ®µ
 */
function createStudentRow(student) {
    const canEdit = currentUser.role === 'admin' ||
                   (currentUser.role === 'teacher') ||
                   (currentUser.role === 'student' && student.user_id === currentUser.id);

    return `
        <tr data-student-id="${student.id}">
            <td>${student.name}</td>
            <td>${student.student_id}</td>
            <td>${student.class_name}</td>
            <td>${student.phone || '-'}</td>
            <td>${student.email || '-'}</td>
            ${shouldShowSensitiveData() ?
                `<td>${student.address || '-'}</td><td>${student.id_card || '-'}</td>` :
                ''
            }
            <td>
                ${canEdit ?
                    `<button class="btn btn-sm btn-outline-primary" onclick="editStudent(${student.id})">ç¼–è¾‘</button>` :
                    '<button class="btn btn-sm btn-outline-secondary" onclick="viewStudent(' + student.id + ')">æŸ¥çœ‹</button>'
                }
                ${currentUser.role === 'admin' ?
                    `<button class="btn btn-sm btn-outline-danger" onclick="deleteStudent(${student.id})">åˆ é™¤</button>` :
                    ''
                }
            </td>
        </tr>
    `;
}

/**
 * åˆ¤æ–­æ˜¯å¦åº”è¯¥æ˜¾ç¤ºæ•æ„Ÿæ•°æ®
 * ç®¡ç†å‘˜å’ŒæŸ¥çœ‹è‡ªå·±ä¿¡æ¯çš„å­¦ç”Ÿå¯ä»¥çœ‹åˆ°æ•æ„Ÿæ•°æ®
 */
function shouldShowSensitiveData() {
    return currentUser.role === 'admin';
}

/**
 * ç”¨æˆ·é€€å‡ºç™»å½•
 * æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„è®¤è¯ä¿¡æ¯å¹¶è·³è½¬åˆ°ç™»å½•é¡µé¢
 */
function logout() {
    // æ¸…é™¤æœ¬åœ°å­˜å‚¨çš„è®¤è¯ä»¤ç‰Œ
    localStorage.removeItem('token');
    localStorage.removeItem('user');

    // è·³è½¬åˆ°ç™»å½•é¡µé¢
    window.location.href = 'login.html';
}

/**
 * æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
 */
function showError(message) {
    const contentArea = document.getElementById('content-area');
    contentArea.innerHTML = `
        <div class="alert alert-danger">
            <h4>é”™è¯¯</h4>
            <p>${message}</p>
        </div>
    `;
}

/**
 * è·å–å”¯ä¸€çš„ç­çº§åˆ—è¡¨
 * ç”¨äºç­›é€‰ä¸‹æ‹‰æ¡†
 */
function getUniqueClasses(students) {
    const classes = students.map(s => s.class_name).filter(Boolean);
    return [...new Set(classes)].sort();
}

/**
 * ç­›é€‰å­¦ç”Ÿåˆ—è¡¨
 * æ ¹æ®æœç´¢å…³é”®è¯å’Œç­çº§ç­›é€‰
 */
function filterStudents() {
    const searchTerm = document.getElementById('search-input').value.toLowerCase();
    const classFilter = document.getElementById('class-filter').value;
    const rows = document.querySelectorAll('#students-table tbody tr');

    rows.forEach(row => {
        const name = row.cells[0].textContent.toLowerCase();
        const studentId = row.cells[1].textContent.toLowerCase();
        const className = row.cells[2].textContent;

        const matchesSearch = name.includes(searchTerm) || studentId.includes(searchTerm);
        const matchesClass = !classFilter || className === classFilter;

        row.style.display = matchesSearch && matchesClass ? '' : 'none';
    });
}
```

## æ•°æ®åº“è®¾è®¡

### æ•°æ®åº“è¡¨ç»“æ„ (database/schema.sql)
```sql
-- åˆ›å»ºæ•°æ®åº“
CREATE DATABASE IF NOT EXISTS student_mgmt
CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

USE student_mgmt;

-- ç”¨æˆ·è¡¨ - å­˜å‚¨ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ï¼ˆç®¡ç†å‘˜ã€æ•™å¸ˆã€å­¦ç”Ÿï¼‰
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,           -- ä¸»é”®ï¼Œè‡ªå¢ID
    username VARCHAR(50) UNIQUE NOT NULL,        -- ç”¨æˆ·åï¼Œå”¯ä¸€
    password_hash VARCHAR(255) NOT NULL,         -- å¯†ç å“ˆå¸Œå€¼ï¼Œå®‰å…¨å­˜å‚¨
    email VARCHAR(100) UNIQUE,                   -- é‚®ç®±åœ°å€ï¼Œå”¯ä¸€
    role ENUM('admin', 'teacher', 'student') NOT NULL,  -- ç”¨æˆ·è§’è‰²æšä¸¾
    status ENUM('active', 'inactive') DEFAULT 'active', -- ç”¨æˆ·çŠ¶æ€
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,     -- åˆ›å»ºæ—¶é—´
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,  -- æ›´æ–°æ—¶é—´

    INDEX idx_username (username),               -- ç”¨æˆ·åç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½
    INDEX idx_email (email),                     -- é‚®ç®±ç´¢å¼•
    INDEX idx_role (role)                        -- è§’è‰²ç´¢å¼•
) ENGINE=InnoDB COMMENT='ç³»ç»Ÿç”¨æˆ·è¡¨';

-- å­¦ç”Ÿä¿¡æ¯è¡¨ - å­˜å‚¨å­¦ç”Ÿè¯¦ç»†ä¿¡æ¯
CREATE TABLE students (
    id INT PRIMARY KEY AUTO_INCREMENT,           -- ä¸»é”®
    user_id INT,                                 -- å…³è”ç”¨æˆ·è¡¨çš„å¤–é”®
    name VARCHAR(50) NOT NULL,                   -- å­¦ç”Ÿå§“å
    student_id VARCHAR(20) UNIQUE NOT NULL,      -- å­¦å·ï¼Œå”¯ä¸€æ ‡è¯†
    class_name VARCHAR(50),                      -- ç­çº§åç§°
    phone VARCHAR(20),                           -- è”ç³»ç”µè¯
    email VARCHAR(100),                          -- é‚®ç®±åœ°å€
    address TEXT,                                -- å®¶åº­ä½å€ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
    id_card VARCHAR(18),                         -- èº«ä»½è¯å·ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼‰
    birth_date DATE,                             -- å‡ºç”Ÿæ—¥æœŸ
    gender ENUM('male', 'female', 'other'),      -- æ€§åˆ«
    enrollment_date DATE,                        -- å…¥å­¦æ—¥æœŸ
    graduation_date DATE,                        -- æ¯•ä¸šæ—¥æœŸ
    status ENUM('active', 'graduated', 'suspended') DEFAULT 'active',  -- å­¦ç”ŸçŠ¶æ€
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    -- å¤–é”®çº¦æŸï¼Œç¡®ä¿æ•°æ®å®Œæ•´æ€§
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,

    -- ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
    INDEX idx_student_id (student_id),           -- å­¦å·ç´¢å¼•
    INDEX idx_class_name (class_name),           -- ç­çº§ç´¢å¼•
    INDEX idx_name (name),                       -- å§“åç´¢å¼•
    INDEX idx_status (status)                    -- çŠ¶æ€ç´¢å¼•
) ENGINE=InnoDB COMMENT='å­¦ç”Ÿä¿¡æ¯è¡¨';

-- ç­çº§è¡¨ - å­˜å‚¨ç­çº§ä¿¡æ¯
CREATE TABLE classes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    class_name VARCHAR(50) UNIQUE NOT NULL,      -- ç­çº§åç§°
    teacher_id INT,                              -- ç­ä¸»ä»»ID
    grade_level INT,                             -- å¹´çº§
    academic_year VARCHAR(10),                   -- å­¦å¹´ï¼Œå¦‚"2023-2024"
    max_students INT DEFAULT 50,                 -- æœ€å¤§å­¦ç”Ÿæ•°
    description TEXT,                            -- ç­çº§æè¿°
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

    FOREIGN KEY (teacher_id) REFERENCES users(id) ON DELETE SET NULL,
    INDEX idx_class_name (class_name),
    INDEX idx_teacher_id (teacher_id)
) ENGINE=InnoDB COMMENT='ç­çº§ä¿¡æ¯è¡¨';

-- ç³»ç»Ÿæ—¥å¿—è¡¨ - è®°å½•é‡è¦æ“ä½œ
CREATE TABLE system_logs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,                                 -- æ“ä½œç”¨æˆ·ID
    action VARCHAR(100) NOT NULL,                -- æ“ä½œç±»å‹
    target_type VARCHAR(50),                     -- æ“ä½œå¯¹è±¡ç±»å‹
    target_id INT,                               -- æ“ä½œå¯¹è±¡ID
    description TEXT,                            -- æ“ä½œæè¿°
    ip_address VARCHAR(45),                      -- æ“ä½œIPåœ°å€
    user_agent TEXT,                             -- ç”¨æˆ·ä»£ç†ä¿¡æ¯
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,
    INDEX idx_user_id (user_id),
    INDEX idx_action (action),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB COMMENT='ç³»ç»Ÿæ“ä½œæ—¥å¿—è¡¨';
```

### åˆå§‹æ•°æ® (database/init_data.sql)
```sql
-- æ’å…¥åˆå§‹ç®¡ç†å‘˜ç”¨æˆ·
-- å¯†ç ä½¿ç”¨bcryptå“ˆå¸Œï¼Œè¿™é‡Œçš„å“ˆå¸Œå€¼å¯¹åº”å¯†ç "admin123"
INSERT INTO users (username, password_hash, email, role) VALUES
('admin', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/VcSAg/9qm', 'admin@school.com', 'admin');

-- æ’å…¥ç¤ºä¾‹æ•™å¸ˆç”¨æˆ·
INSERT INTO users (username, password_hash, email, role) VALUES
('teacher1', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/VcSAg/9qm', 'teacher1@school.com', 'teacher'),
('teacher2', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/VcSAg/9qm', 'teacher2@school.com', 'teacher');

-- æ’å…¥ç¤ºä¾‹å­¦ç”Ÿç”¨æˆ·
INSERT INTO users (username, password_hash, email, role) VALUES
('student1', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/VcSAg/9qm', 'student1@school.com', 'student'),
('student2', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/VcSAg/9qm', 'student2@school.com', 'student');

-- æ’å…¥ç­çº§ä¿¡æ¯
INSERT INTO classes (class_name, teacher_id, grade_level, academic_year) VALUES
('é«˜ä¸€(1)ç­', 2, 1, '2023-2024'),
('é«˜ä¸€(2)ç­', 3, 1, '2023-2024');

-- æ’å…¥å­¦ç”Ÿä¿¡æ¯
INSERT INTO students (user_id, name, student_id, class_name, phone, email, address, id_card, birth_date, gender, enrollment_date) VALUES
(4, 'å¼ ä¸‰', '2023001', 'é«˜ä¸€(1)ç­', '13800138001', 'zhangsan@school.com', 'åŒ—äº¬å¸‚æœé˜³åŒºxxxè¡—é“', '110101200501011234', '2005-01-01', 'male', '2023-09-01'),
(5, 'æå››', '2023002', 'é«˜ä¸€(2)ç­', '13800138002', 'lisi@school.com', 'åŒ—äº¬å¸‚æµ·æ·€åŒºxxxè¡—é“', '110108200502021234', '2005-02-02', 'female', '2023-09-01');
```

## é¡¹ç›®è¿è¡ŒæŒ‡å—

### ç¯å¢ƒå‡†å¤‡

#### 1. ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS 10.14+, Ubuntu 18.04+
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **MySQL**: 5.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æµè§ˆå™¨**: Chrome 80+, Firefox 75+, Safari 13+

#### 2. å®‰è£…ä¾èµ–è½¯ä»¶

**å®‰è£…Python**
```bash
# Windows: ä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…
# https://www.python.org/downloads/

# macOS: ä½¿ç”¨Homebrew
brew install python3

# Ubuntu: ä½¿ç”¨apt
sudo apt update
sudo apt install python3 python3-pip
```

**å®‰è£…MySQL**
```bash
# Windows: ä»å®˜ç½‘ä¸‹è½½MySQL Installer
# https://dev.mysql.com/downloads/installer/

# macOS: ä½¿ç”¨Homebrew
brew install mysql
brew services start mysql

# Ubuntu: ä½¿ç”¨apt
sudo apt install mysql-server
sudo systemctl start mysql
sudo systemctl enable mysql
```

### é¡¹ç›®éƒ¨ç½²æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®ä»£ç 
```bash
# ä»GitHubå…‹éš†é¡¹ç›®ï¼ˆå‡è®¾é¡¹ç›®å·²ä¸Šä¼ ï¼‰
git clone https://github.com/your-username/student-management-system.git
cd student-management-system
```

#### 2. åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ - éš”ç¦»é¡¹ç›®ä¾èµ–
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate
```

#### 3. å®‰è£…Pythonä¾èµ–
```bash
# å®‰è£…é¡¹ç›®æ‰€éœ€çš„PythonåŒ…
pip install -r requirements.txt

# requirements.txt å†…å®¹ç¤ºä¾‹ï¼š
# Flask==2.3.2              # Webæ¡†æ¶
# Flask-CORS==4.0.0          # è·¨åŸŸèµ„æºå…±äº«
# mysql-connector-python==8.1.0  # MySQLæ•°æ®åº“è¿æ¥å™¨
# PyJWT==2.8.0               # JWTä»¤ç‰Œå¤„ç†
# bcrypt==4.0.1              # å¯†ç å“ˆå¸Œ
# python-dotenv==1.0.0       # ç¯å¢ƒå˜é‡ç®¡ç†
```

#### 4. é…ç½®æ•°æ®åº“

**åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·**
```bash
# ç™»å½•MySQL
mysql -u root -p

# åœ¨MySQLä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
CREATE DATABASE student_mgmt CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'student_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON student_mgmt.* TO 'student_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

**å¯¼å…¥æ•°æ®åº“ç»“æ„å’Œåˆå§‹æ•°æ®**
```bash
# å¯¼å…¥æ•°æ®åº“ç»“æ„
mysql -u student_user -p student_mgmt < database/schema.sql

# å¯¼å…¥åˆå§‹æ•°æ®
mysql -u student_user -p student_mgmt < database/init_data.sql
```

#### 5. é…ç½®ç¯å¢ƒå˜é‡

**åˆ›å»º .env æ–‡ä»¶**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º .env æ–‡ä»¶
touch .env

# .env æ–‡ä»¶å†…å®¹ï¼š
DB_HOST=localhost
DB_PORT=3306
DB_USER=student_user
DB_PASSWORD=your_password
DB_NAME=student_mgmt
SECRET_KEY=your-secret-key-here-make-it-long-and-random
FLASK_ENV=development
FLASK_DEBUG=True
```

#### 6. å¯åŠ¨åç«¯æœåŠ¡

**åˆ›å»ºä¸»åº”ç”¨æ–‡ä»¶ (app.py)**
```python
from flask import Flask, render_template
from flask_cors import CORS
from routes.auth import auth_bp
from routes.student import student_bp
from routes.user import user_bp
import os
from dotenv import load_dotenv

# åŠ è½½ç¯å¢ƒå˜é‡
load_dotenv()

# åˆ›å»ºFlaskåº”ç”¨å®ä¾‹
app = Flask(__name__)

# é…ç½®åº”ç”¨
app.config['SECRET_KEY'] = os.getenv('SECRET_KEY')
app.config['DEBUG'] = os.getenv('FLASK_DEBUG', 'False').lower() == 'true'

# å¯ç”¨è·¨åŸŸèµ„æºå…±äº« - å…è®¸å‰ç«¯è°ƒç”¨åç«¯API
CORS(app)

# æ³¨å†Œè“å›¾ - ç»„ç»‡è·¯ç”±
app.register_blueprint(auth_bp, url_prefix='/api/auth')
app.register_blueprint(student_bp, url_prefix='/api')
app.register_blueprint(user_bp, url_prefix='/api')

# é™æ€æ–‡ä»¶è·¯ç”± - æä¾›å‰ç«¯é¡µé¢
@app.route('/')
def index():
    return render_template('index.html')

@app.route('/login')
def login():
    return render_template('login.html')

@app.route('/dashboard')
def dashboard():
    return render_template('dashboard.html')

# é”™è¯¯å¤„ç†
@app.errorhandler(404)
def not_found(error):
    return {'success': False, 'message': 'èµ„æºä¸å­˜åœ¨'}, 404

@app.errorhandler(500)
def internal_error(error):
    return {'success': False, 'message': 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'}, 500

if __name__ == '__main__':
    # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
    app.run(
        host='0.0.0.0',      # ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£
        port=5000,           # ç«¯å£å·
        debug=True           # å¼€å¯è°ƒè¯•æ¨¡å¼
    )
```

**å¯åŠ¨åç«¯æœåŠ¡**
```bash
# ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
source venv/bin/activate  # Linux/macOS
# æˆ– venv\Scripts\activate  # Windows

# å¯åŠ¨Flaskåº”ç”¨
python app.py

# æœåŠ¡å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š
# * Running on all addresses (0.0.0.0)
# * Running on http://127.0.0.1:5000
# * Running on http://[your-ip]:5000
```

#### 7. å¯åŠ¨å‰ç«¯æœåŠ¡

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨Pythonå†…ç½®æœåŠ¡å™¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨ç®€å•HTTPæœåŠ¡å™¨
cd frontend
python -m http.server 8080

# è®¿é—® http://localhost:8080
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨Nginxï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰**
```bash
# å®‰è£…Nginx
sudo apt install nginx  # Ubuntu
brew install nginx      # macOS

# é…ç½®Nginx
sudo nano /etc/nginx/sites-available/student-mgmt

# Nginxé…ç½®å†…å®¹ï¼š
server {
    listen 80;
    server_name localhost;
    root /path/to/your/project/frontend;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}

# å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/student-mgmt /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

### ç³»ç»Ÿä½¿ç”¨æµç¨‹

#### 1. ç”¨æˆ·ç™»å½•æµç¨‹
```
ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢ â†’ è¾“å…¥ç”¨æˆ·åå¯†ç  â†’ å‰ç«¯å‘é€ç™»å½•è¯·æ±‚ â†’
åç«¯éªŒè¯ç”¨æˆ·ä¿¡æ¯ â†’ ç”ŸæˆJWTä»¤ç‰Œ â†’ è¿”å›ä»¤ç‰Œç»™å‰ç«¯ â†’
å‰ç«¯å­˜å‚¨ä»¤ç‰Œ â†’ è·³è½¬åˆ°ä»ªè¡¨æ¿é¡µé¢
```

#### 2. æ•°æ®æŸ¥è¯¢æµç¨‹
```
ç”¨æˆ·ç‚¹å‡»å­¦ç”Ÿç®¡ç† â†’ å‰ç«¯å‘é€APIè¯·æ±‚ï¼ˆæºå¸¦JWTä»¤ç‰Œï¼‰ â†’
åç«¯éªŒè¯ä»¤ç‰Œ â†’ æ£€æŸ¥ç”¨æˆ·æƒé™ â†’ æ ¹æ®æƒé™æŸ¥è¯¢æ•°æ®åº“ â†’
è¿”å›ç›¸åº”æ•°æ® â†’ å‰ç«¯æ¸²æŸ“é¡µé¢æ˜¾ç¤ºæ•°æ®
```

#### 3. æƒé™æ§åˆ¶æµç¨‹
```
æ¯ä¸ªAPIè¯·æ±‚ â†’ æ£€æŸ¥Authorizationå¤´ â†’ éªŒè¯JWTä»¤ç‰Œ â†’
è§£æç”¨æˆ·è§’è‰² â†’ æ ¹æ®è§’è‰²æ‰§è¡Œç›¸åº”çš„æ•°æ®åº“æŸ¥è¯¢ â†’
è¿”å›ç”¨æˆ·æœ‰æƒé™æŸ¥çœ‹çš„æ•°æ®
```

## é¡¹ç›®ç‰¹ç‚¹ä¸ä¼˜åŠ¿

### 1. å®‰å…¨æ€§
- **å¯†ç åŠ å¯†**: ä½¿ç”¨bcryptå¯¹å¯†ç è¿›è¡Œå“ˆå¸Œå­˜å‚¨
- **JWTè®¤è¯**: ä½¿ç”¨JSON Web Tokenè¿›è¡Œç”¨æˆ·è®¤è¯
- **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é˜²æ­¢SQLæ³¨å…¥
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)

### 2. å¯æ‰©å±•æ€§
- **æ¨¡å—åŒ–è®¾è®¡**: å‰åç«¯åˆ†ç¦»ï¼Œä¾¿äºç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²
- **è“å›¾æ¶æ„**: Flaskè“å›¾ç»„ç»‡è·¯ç”±ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•
- **æ•°æ®åº“è®¾è®¡**: è§„èŒƒåŒ–çš„æ•°æ®åº“è®¾è®¡ï¼Œæ”¯æŒä¸šåŠ¡æ‰©å±•

### 3. ç”¨æˆ·ä½“éªŒ
- **å“åº”å¼è®¾è®¡**: æ”¯æŒå¤šç§è®¾å¤‡è®¿é—®
- **å•é¡µåº”ç”¨**: æ— åˆ·æ–°é¡µé¢åˆ‡æ¢ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- **æƒé™å¯è§†åŒ–**: æ ¹æ®ç”¨æˆ·è§’è‰²åŠ¨æ€æ˜¾ç¤ºåŠŸèƒ½èœå•

### 4. ç»´æŠ¤æ€§
- **ä»£ç æ³¨é‡Š**: è¯¦ç»†çš„ä»£ç æ³¨é‡Šä¾¿äºç†è§£å’Œç»´æŠ¤
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **æ—¥å¿—è®°å½•**: ç³»ç»Ÿæ“ä½œæ—¥å¿—ä¾¿äºé—®é¢˜æ’æŸ¥

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. æ•°æ®åº“è¿æ¥é—®é¢˜
```python
# é—®é¢˜ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥
# è§£å†³ï¼šæ£€æŸ¥æ•°æ®åº“é…ç½®å’Œç½‘ç»œè¿æ¥
try:
    connection = mysql.connector.connect(**config)
    print("æ•°æ®åº“è¿æ¥æˆåŠŸ")
except mysql.connector.Error as err:
    print(f"æ•°æ®åº“è¿æ¥å¤±è´¥: {err}")
    # æ£€æŸ¥é…ç½®ä¿¡æ¯æ˜¯å¦æ­£ç¡®
```

### 2. è·¨åŸŸé—®é¢˜
```python
# é—®é¢˜ï¼šå‰ç«¯æ— æ³•è®¿é—®åç«¯API
# è§£å†³ï¼šé…ç½®CORS
from flask_cors import CORS
CORS(app, origins=['http://localhost:8080'])
```

### 3. JWTä»¤ç‰Œè¿‡æœŸ
```javascript
// é—®é¢˜ï¼šä»¤ç‰Œè¿‡æœŸå¯¼è‡´è¯·æ±‚å¤±è´¥
// è§£å†³ï¼šè‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œæˆ–é‡æ–°ç™»å½•
if (response.status === 401) {
    localStorage.removeItem('token');
    window.location.href = '/login';
}
```

## æ€»ç»“

æœ¬å­¦ç”Ÿç®¡ç†ç³»ç»Ÿé‡‡ç”¨ç°ä»£Webå¼€å‘æŠ€æœ¯æ ˆï¼Œå®ç°äº†å®Œæ•´çš„å­¦ç”Ÿä¿¡æ¯ç®¡ç†åŠŸèƒ½ã€‚ç³»ç»Ÿå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒç‰¹å¾ï¼š

1. **å‰åç«¯åˆ†ç¦»æ¶æ„**: å‰ç«¯ä½¿ç”¨HTML/CSS/JavaScriptï¼Œåç«¯ä½¿ç”¨Python Flaskï¼Œé€šè¿‡RESTful APIè¿›è¡Œé€šä¿¡
2. **åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶**: æ”¯æŒç®¡ç†å‘˜ã€æ•™å¸ˆã€å­¦ç”Ÿä¸‰ç§è§’è‰²ï¼Œæ¯ç§è§’è‰²å…·æœ‰ä¸åŒçš„æ•°æ®è®¿é—®æƒé™
3. **å®‰å…¨çš„ç”¨æˆ·è®¤è¯**: ä½¿ç”¨JWTä»¤ç‰Œè¿›è¡Œç”¨æˆ·è®¤è¯ï¼Œå¯†ç é‡‡ç”¨bcryptåŠ å¯†å­˜å‚¨
4. **å“åº”å¼ç”¨æˆ·ç•Œé¢**: æ”¯æŒå¤šç§è®¾å¤‡è®¿é—®ï¼Œæä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ
5. **å¯æ‰©å±•çš„ç³»ç»Ÿæ¶æ„**: æ¨¡å—åŒ–è®¾è®¡ä¾¿äºåŠŸèƒ½æ‰©å±•å’Œç»´æŠ¤

é€šè¿‡æœ¬é¡¹ç›®çš„å­¦ä¹ å’Œå®è·µï¼Œå¯ä»¥æŒæ¡ç°ä»£Webåº”ç”¨å¼€å‘çš„æ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼Œä¸ºåç»­çš„é¡¹ç›®å¼€å‘å¥ å®šåšå®åŸºç¡€ã€‚
```
```
```
